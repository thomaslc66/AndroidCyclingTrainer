<html>
<head>
<title>Timer.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: rgb(0,0,0); font-weight: normal; font-style: normal; }
.s0 { color: rgb(98,151,85); font-style: italic; }
.s1 { color: rgb(169,183,198); }
.s2 { color: rgb(204,120,50); }
.s3 { color: rgb(128,128,128); }
.s4 { color: rgb(104,151,187); }
.s5 { color: rgb(106,135,89); }
</style>
</head>
<BODY BGCOLOR="#2b2b2b">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
Timer.java</FONT>
</center></TD></TR></TABLE>
<pre>

<span class="s0">/*************************************************************** 
 * Programm  : Android Cycling Trainer 
 * Society   : ETML 
 * Author    : Thomas LÃ©chaire 
 * Date      : 26.05.2015 
 * Goal      : Class used to display CountDown and Timer for the user to 
 *              see Row during Training  
 ******************************************************************** // 
 * Modifications: 
 * Date       : XX.XX.XXXX 
 * Author     : 
 * Purpose     : 
 *********************************************************************/</span><span class="s1"> 
</span><span class="s2">package </span><span class="s1">tpi.lechaireth.com.androidcyclingtrainer</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s2">import </span><span class="s1">android.app.Activity</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.app.AlertDialog</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.app.Dialog</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.content.Context</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.content.DialogInterface</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.content.Intent</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.content.res.Configuration</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.os.Bundle</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s2">import </span><span class="s1">android.os.Handler</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.text.Editable</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.text.TextWatcher</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.util.Log</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.view.LayoutInflater</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.view.View</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.view.inputmethod.EditorInfo</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.view.inputmethod.InputMethodManager</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.Button</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.EditText</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.ProgressBar</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.TextView</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.Toast</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s2">import </span><span class="s1">org.w3c.dom.Text</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s2">import </span><span class="s1">java.text.NumberFormat</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">java.text.ParsePosition</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">java.util.List</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s2">import </span><span class="s1">tpi.lechaireth.com.androidcyclingtrainer.DB.RealmDB</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">tpi.lechaireth.com.androidcyclingtrainer.DB.TrainingRow</span><span class="s2">;</span><span class="s1"> 
 
 
</span><span class="s2">public class </span><span class="s1">Timer </span><span class="s2">extends </span><span class="s1">Activity { 
 
    </span><span class="s3">//UI Elements</span><span class="s1"> 
    </span><span class="s3">/* two progress Bar for time and row time */</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">ProgressBar prBar_total</span><span class="s2">, </span><span class="s1">prBar_row</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* all TextView for the UI display */</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">TextView txtView_gear</span><span class="s2">, </span><span class="s1">txtView_note</span><span class="s2">, </span><span class="s1">txtView_timRow</span><span class="s2">,</span><span class="s1">txtView_rythm_value </span><span class="s2">,</span><span class="s1">txtView_work_value </span><span class="s2">,</span><span class="s1">txtView_bpm_value</span><span class="s2">, </span><span class="s1">txtView_rpm_value</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">Button btn_start</span><span class="s2">, </span><span class="s1">btn_stop</span><span class="s2">, </span><span class="s1">btn_pause</span><span class="s2">;</span><span class="s1"> 
 
    </span><span class="s3">//Object</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">List&lt;TrainingRow&gt; lst_trainingRow</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">RealmDB realmDB</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">List&lt;Integer&gt; lst_time</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* test with handler */</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">Handler handler = </span><span class="s2">new </span><span class="s1">Handler()</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">TimerRunnable runnable = </span><span class="s2">new </span><span class="s1">TimerRunnable()</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">AlertDialog alertDialog</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">TextView txtView_textWatcher</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">EditText edt_input</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">Context mContext</span><span class="s2">;</span><span class="s1"> 
 
    </span><span class="s3">//VARIABLES</span><span class="s1"> 
    </span><span class="s2">private int </span><span class="s1">_id</span><span class="s2">;</span><span class="s1"> 
 
    </span><span class="s3">//Varibales for the Timer</span><span class="s1"> 
    </span><span class="s3">/* Int to translate seconds in milliseconds */</span><span class="s1"> 
    </span><span class="s2">private static int </span><span class="s1">INT_MILLIS = </span><span class="s4">1000</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* variable for the seconds/minutes */</span><span class="s1"> 
    </span><span class="s2">private static int </span><span class="s1">INT_SEC = </span><span class="s4">60</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* time of the first row */</span><span class="s1"> 
    </span><span class="s2">private int </span><span class="s1">int_time_first_row</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* total time in milliseconds */</span><span class="s1"> 
    </span><span class="s2">private int </span><span class="s1">int_total_timeInMillis</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* boolean if the time isCanceled or isPaused */</span><span class="s1"> 
    </span><span class="s2">private boolean </span><span class="s1">isCanceled = </span><span class="s2">false;</span><span class="s1"> 
    </span><span class="s3">/* variable to hold the value of the Intervals */</span><span class="s1"> 
    </span><span class="s2">private final int </span><span class="s1">INTERVALS = </span><span class="s4">100</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* variable incremented for the progress */</span><span class="s1"> 
    </span><span class="s2">private int </span><span class="s1">int_progress_value</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* variable to hold the progress of the row time */</span><span class="s1"> 
    </span><span class="s2">private int </span><span class="s1">int_progress_rowTime</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">// Volatile beacause those variable are accesed by to different class</span><span class="s1"> 
    </span><span class="s3">/* int_i variable that hold the id of the row */</span><span class="s1"> 
    </span><span class="s2">private volatile int </span><span class="s1">int_i = </span><span class="s4">0</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* variable to hold the time for the row */</span><span class="s1"> 
    </span><span class="s2">private volatile int </span><span class="s1">int_row_time</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s3">/* variable to hold the time only for display */</span><span class="s1"> 
    </span><span class="s2">private volatile int </span><span class="s1">int_rowTime_display</span><span class="s2">;</span><span class="s1"> 
 
    </span><span class="s3">//CONSTANTS</span><span class="s1"> 
    </span><span class="s2">private static int </span><span class="s1">INT_BPM_LENGTH = </span><span class="s4">3</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private static int </span><span class="s1">INT_ZERO = </span><span class="s4">0</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private static int </span><span class="s1">INT_MAX_BPM = </span><span class="s4">250</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private static int </span><span class="s1">INT_MIN_BPM = </span><span class="s4">30</span><span class="s2">;</span><span class="s1"> 
 
    @Override 
    </span><span class="s2">protected void </span><span class="s1">onCreate(Bundle savedInstanceState) { 
        </span><span class="s2">super</span><span class="s1">.onCreate(savedInstanceState)</span><span class="s2">;</span><span class="s1"> 
        setContentView(R.layout.activity_training)</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">//set context</span><span class="s1"> 
        mContext = Timer.</span><span class="s2">this;</span><span class="s1"> 
 
        </span><span class="s3">/* the 3 buttons */</span><span class="s1"> 
        btn_start = (Button) findViewById(R.id.btn_start)</span><span class="s2">;</span><span class="s1"> 
        btn_pause = (Button) findViewById(R.id.btn_pause)</span><span class="s2">;</span><span class="s1"> 
        btn_stop = (Button) findViewById(R.id.btn_stop)</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">/* all textView to display data */</span><span class="s1"> 
        txtView_timRow = (TextView) findViewById(R.id.txtView_rowTime)</span><span class="s2">;</span><span class="s1"> 
        txtView_rythm_value = (TextView) findViewById(R.id.txtView_rythm_value)</span><span class="s2">;</span><span class="s1"> 
        txtView_work_value = (TextView) findViewById(R.id.txtView_work_value)</span><span class="s2">;</span><span class="s1"> 
        txtView_bpm_value = (TextView) findViewById(R.id.txtView_bpm_value)</span><span class="s2">;</span><span class="s1"> 
        txtView_rpm_value = (TextView) findViewById(R.id.txtView_rpm_value)</span><span class="s2">;</span><span class="s1"> 
        txtView_note = (TextView) findViewById(R.id.txtView_notes_value)</span><span class="s2">;</span><span class="s1"> 
        txtView_gear = (TextView) findViewById(R.id.txtView_gear_value)</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">/* the two progressBar */</span><span class="s1"> 
        prBar_row = (ProgressBar) findViewById(R.id.progressBar_row)</span><span class="s2">;</span><span class="s1"> 
        prBar_total = (ProgressBar) findViewById(R.id.progressBar_total)</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">//get the id of the training from the last actvity</span><span class="s1"> 
        _id = getIntent().getIntExtra(</span><span class="s5">&quot;_id&quot;</span><span class="s2">, </span><span class="s4">0</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">//get from RealmDB total time and all Rows</span><span class="s1"> 
        realmDB = </span><span class="s2">new </span><span class="s1">RealmDB(Timer.</span><span class="s2">this</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s3">//get all Rows</span><span class="s1"> 
        lst_trainingRow = realmDB.getAllTrainingRows(_id)</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s3">//get time of all cumulate rows</span><span class="s1"> 
        lst_time = realmDB.calculateTotalMinAndSec(_id)</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">//set the value for the first row</span><span class="s1"> 
        </span><span class="s3">//time for the row</span><span class="s1"> 
        txtView_timRow.setText(lst_trainingRow.get(int_i).getStr_time())</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s3">//value for the row</span><span class="s1"> 
        txtView_rpm_value.setText(lst_trainingRow.get(int_i).getInt_rpm()+</span><span class="s5">&quot;&quot;</span><span class="s1">)</span><span class="s2">; </span><span class="s3">//rpm</span><span class="s1"> 
        txtView_bpm_value.setText(lst_trainingRow.get(int_i).getInt_bpm()+</span><span class="s5">&quot;&quot;</span><span class="s1">)</span><span class="s2">; </span><span class="s3">//bpm</span><span class="s1"> 
        txtView_rythm_value.setText(lst_trainingRow.get(int_i).getStr_rythm())</span><span class="s2">; </span><span class="s3">//rythme</span><span class="s1"> 
        txtView_work_value.setText(lst_trainingRow.get(int_i).getStr_work())</span><span class="s2">; </span><span class="s3">//work</span><span class="s1"> 
        txtView_note.setText(lst_trainingRow.get(int_i).getStr_note())</span><span class="s2">; </span><span class="s3">//notes</span><span class="s1"> 
        txtView_gear.setText(lst_trainingRow.get(int_i).getStr_gear())</span><span class="s2">; </span><span class="s3">//gear</span><span class="s1"> 
 
        </span><span class="s3">//get total time in miliseconds</span><span class="s1"> 
        int_total_timeInMillis = ((lst_time.get(</span><span class="s4">0</span><span class="s1">) * INT_SEC) + lst_time.get(</span><span class="s4">1</span><span class="s1">)) * INT_MILLIS</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">//get time of the first row of training</span><span class="s1"> 
        int_time_first_row = (((lst_trainingRow.get(int_i).getInt_min()*INT_SEC) + lst_trainingRow.get(int_i).getInt_sec())* INT_MILLIS)</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">//set the time for the first display</span><span class="s1"> 
        int_rowTime_display = int_time_first_row + </span><span class="s4">1000</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">//set the row time for the first display</span><span class="s1"> 
        int_row_time = int_time_first_row</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s3">//disable Buttons stop and pause before timer is started</span><span class="s1"> 
        btn_stop.setEnabled(</span><span class="s2">false</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
        btn_pause.setEnabled(</span><span class="s2">false</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s0">/************************************ 
         * Button start onClickListener 
         ************************************/</span><span class="s1"> 
        btn_start.setOnClickListener(</span><span class="s2">new </span><span class="s1">View.OnClickListener() { 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onClick(View v) { 
                </span><span class="s3">//set check values to false</span><span class="s1"> 
                isCanceled = </span><span class="s2">false;</span><span class="s1"> 
 
                </span><span class="s2">if </span><span class="s1">(btn_start.getText().equals(getResources().getString(R.string.start))) { 
                    </span><span class="s3">/* set the value for the ProgressBar total = total amount of time */</span><span class="s1"> 
                    prBar_total.setMax(int_total_timeInMillis)</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">/* set the max Value for the progressBar row = tiem of the first Row*/</span><span class="s1"> 
                    prBar_row.setMax(int_time_first_row)</span><span class="s2">;</span><span class="s1"> 
 
                    </span><span class="s3">//enable/disable button</span><span class="s1"> 
                    btn_start.setEnabled(</span><span class="s2">false</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                    btn_pause.setEnabled(</span><span class="s2">true</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                    btn_stop.setEnabled(</span><span class="s2">true</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
                    </span><span class="s3">//call handler post delayed to start the runnable</span><span class="s1"> 
                    handler.postDelayed(runnable</span><span class="s2">, </span><span class="s4">100</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
                } </span><span class="s2">else </span><span class="s1">{ </span><span class="s3">//part for the resume button</span><span class="s1"> 
                    </span><span class="s3">//set the already done progression to the progressBar (prBar_row)</span><span class="s1"> 
                    prBar_row.setProgress(int_progress_rowTime)</span><span class="s2">;</span><span class="s1"> 
 
                    btn_start.setEnabled(</span><span class="s2">false</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                    btn_start.setText(getResources().getString(R.string.start))</span><span class="s2">;</span><span class="s1"> 
 
                    </span><span class="s3">//countDown reRun so we enable pause or stop</span><span class="s1"> 
                    btn_pause.setEnabled(</span><span class="s2">true</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                    btn_stop.setEnabled(</span><span class="s2">true</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
                    </span><span class="s3">//call handler post delayed to resume the runnable</span><span class="s1"> 
                    handler.postDelayed(runnable</span><span class="s2">, </span><span class="s4">100</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
                } 
 
            } 
        })</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s0">/************************************ 
         * Button pause onClickListener 
         ************************************/</span><span class="s1"> 
        btn_pause.setOnClickListener(</span><span class="s2">new </span><span class="s1">View.OnClickListener() { 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onClick(View v) { 
                </span><span class="s3">//call those two methods to cancel the Timer (Runnable)</span><span class="s1"> 
                runnable.killRunnable()</span><span class="s2">;</span><span class="s1"> 
                handler.removeCallbacks(runnable)</span><span class="s2">;</span><span class="s1"> 
 
                </span><span class="s3">//enable resume button. disable Pause button</span><span class="s1"> 
                </span><span class="s3">/* change text of the button start. This way he become the resume button */</span><span class="s1"> 
                btn_start.setText(getResources().getString(R.string.resume))</span><span class="s2">;</span><span class="s1"> 
                btn_start.setEnabled(</span><span class="s2">true</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                btn_stop.setEnabled(</span><span class="s2">true</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                btn_pause.setEnabled(</span><span class="s2">false</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
            } 
        })</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s0">/************************************ 
         * Button stop onClickListener 
         ************************************/</span><span class="s1"> 
        btn_stop.setOnClickListener(</span><span class="s2">new </span><span class="s1">View.OnClickListener() { 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onClick(View v) { 
                </span><span class="s3">//disable all button</span><span class="s1"> 
                btn_start.setEnabled(</span><span class="s2">true</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                </span><span class="s3">//change text of start button in case the user want to continue</span><span class="s1"> 
                btn_start.setText(getResources().getString(R.string.resume))</span><span class="s2">;</span><span class="s1"> 
                btn_stop.setEnabled(</span><span class="s2">false</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                btn_pause.setEnabled(</span><span class="s2">false</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
                </span><span class="s3">//call those two methods to pause the Timer (Runnable)</span><span class="s1"> 
                runnable.killRunnable()</span><span class="s2">;</span><span class="s1"> 
                handler.removeCallbacks(runnable)</span><span class="s2">;</span><span class="s1"> 
 
                </span><span class="s3">//check with an alertDialog if the user realy wants to stop the training.</span><span class="s1"> 
                AlertDialog.Builder builder = </span><span class="s2">new </span><span class="s1">AlertDialog.Builder(mContext) 
                        .setTitle(getResources().getString(R.string.stop_timer)) 
                        .setMessage(getResources().getString(R.string.stop_message)) 
                        .setPositiveButton(</span><span class="s5">&quot;OUI&quot;</span><span class="s2">, new </span><span class="s1">DialogInterface.OnClickListener() { 
                            @Override 
                            </span><span class="s2">public void </span><span class="s1">onClick(DialogInterface dialogInterface</span><span class="s2">, int </span><span class="s1">i) { 
                                </span><span class="s3">//go back to previous activiy if positive button is hit</span><span class="s1"> 
                                Intent intent_trainingRow = </span><span class="s2">new </span><span class="s1">Intent(Timer.</span><span class="s2">this, </span><span class="s1">TrainingRowActivity.</span><span class="s2">class</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//put extra id to get all Rows back</span><span class="s1"> 
                                intent_trainingRow.putExtra(</span><span class="s5">&quot;_id&quot;</span><span class="s2">, </span><span class="s1">_id)</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//put a Flag to avoid recreate intent if he already exist in the queue</span><span class="s1"> 
                                intent_trainingRow.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//get context to startActivity</span><span class="s1"> 
                                mContext.startActivity(intent_trainingRow)</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//finish and cancel activty</span><span class="s1"> 
                                finish()</span><span class="s2">;</span><span class="s1"> 
                            } 
                        }) 
                        .setNegativeButton(</span><span class="s5">&quot;NON&quot;</span><span class="s2">, new </span><span class="s1">DialogInterface.OnClickListener() { 
                            @Override 
                            </span><span class="s2">public void </span><span class="s1">onClick(DialogInterface dialogInterface</span><span class="s2">, int </span><span class="s1">i) { 
                                </span><span class="s3">//cancel the alertDialog</span><span class="s1"> 
                                dialogInterface.dismiss()</span><span class="s2">;</span><span class="s1"> 
                            } 
                        })</span><span class="s2">;</span><span class="s1"> 
                </span><span class="s3">//from the builder create the alertDialog</span><span class="s1"> 
                alertDialog = builder.create()</span><span class="s2">;</span><span class="s1"> 
                </span><span class="s3">//show the dialog to user</span><span class="s1"> 
                alertDialog.show()</span><span class="s2">;</span><span class="s1"> 
 
            } 
        })</span><span class="s2">;</span><span class="s1"> 
    } 
 
 
    </span><span class="s0">/******************************************************** 
     * 
     * Custom class TimerRunnable 
     * Manage the Timer element and the progressBar progress 
     * 
     *******************************************************/</span><span class="s1"> 
    </span><span class="s2">private class </span><span class="s1">TimerRunnable </span><span class="s2">implements </span><span class="s1">Runnable { 
 
        </span><span class="s3">//variables to create a TrainingRow</span><span class="s1"> 
        </span><span class="s2">private int </span><span class="s1">int_min</span><span class="s2">, </span><span class="s1">int_sec</span><span class="s2">, </span><span class="s1">int_rpm</span><span class="s2">, </span><span class="s1">int_bpm</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s2">private </span><span class="s1">String str_gear</span><span class="s2">, </span><span class="s1">str_time</span><span class="s2">, </span><span class="s1">str_work</span><span class="s2">, </span><span class="s1">str_rythm</span><span class="s2">, </span><span class="s1">str_note</span><span class="s2">;</span><span class="s1"> 
 
        @Override 
        </span><span class="s2">public void </span><span class="s1">run() { 
                </span><span class="s3">//check if timer is paused or if total time is finish</span><span class="s1"> 
                </span><span class="s2">if </span><span class="s1">(isCanceled == </span><span class="s2">true  </span><span class="s1">|| int_total_timeInMillis == int_progress_value) { 
                    </span><span class="s3">//set runnable to null</span><span class="s1"> 
                    runnable = </span><span class="s2">null;</span><span class="s1"> 
                    </span><span class="s3">//if the time is finish. get the alert Dialog for the rest indice</span><span class="s1"> 
                    </span><span class="s2">if</span><span class="s1">(int_total_timeInMillis == int_progress_value){ 
                        </span><span class="s3">//inflate the layout to diplay the dialog layout created</span><span class="s1"> 
                        LayoutInflater mInflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE)</span><span class="s2">;</span><span class="s1"> 
                        View rest_dialog = mInflater.inflate(R.layout.rest_indice_dialog</span><span class="s2">, null</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
                        edt_input = (EditText) rest_dialog.findViewById(R.id.edt_input)</span><span class="s2">;</span><span class="s1"> 
                        </span><span class="s3">//set keyboard to numeric</span><span class="s1"> 
                        edt_input.setRawInputType(Configuration.KEYBOARD_QWERTY)</span><span class="s2">;</span><span class="s1"> 
                        </span><span class="s3">//let done button appears</span><span class="s1"> 
                        edt_input.setImeOptions(EditorInfo.IME_ACTION_DONE)</span><span class="s2">;</span><span class="s1"> 
                        </span><span class="s3">//let keyboard appears automaticaly</span><span class="s1"> 
                                    </span><span class="s3">/* set On Focus Change Listener to open keyBord when editText fc_max has focus*/</span><span class="s1"> 
                        edt_input.setOnFocusChangeListener(</span><span class="s2">new </span><span class="s1">View.OnFocusChangeListener() { 
                            @Override 
                            </span><span class="s2">public void </span><span class="s1">onFocusChange(View v</span><span class="s2">, boolean </span><span class="s1">hasFocus) { 
                                edt_input.post(</span><span class="s2">new </span><span class="s1">Runnable() { 
                                    @Override 
                                    </span><span class="s2">public void </span><span class="s1">run() { 
                                        </span><span class="s3">//Make KeyBoard Visible</span><span class="s1"> 
                                        InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE)</span><span class="s2">;</span><span class="s1"> 
                                        imm.showSoftInput(edt_input</span><span class="s2">, </span><span class="s1">InputMethodManager.SHOW_IMPLICIT)</span><span class="s2">;</span><span class="s1"> 
                                    } 
                                })</span><span class="s2">;</span><span class="s1"> 
                            } 
                        })</span><span class="s2">;</span><span class="s1"> 
 
                        </span><span class="s3">// set cursor into edit Text</span><span class="s1"> 
                        edt_input.requestFocus()</span><span class="s2">;</span><span class="s1"> 
 
                        txtView_textWatcher = (TextView) rest_dialog.findViewById(R.id.txtView_textWatcher)</span><span class="s2">;</span><span class="s1"> 
                        </span><span class="s3">//set Text in text Watcher</span><span class="s1"> 
                        txtView_textWatcher.setText(String.valueOf(INT_BPM_LENGTH))</span><span class="s2">;</span><span class="s1"> 
 
                        </span><span class="s3">//Create a TextWatcher for the editText input</span><span class="s1"> 
                        TextWatcher mTextWatcher_forEdt_input = </span><span class="s2">new </span><span class="s1">TextWatcher() { 
                            @Override 
                            </span><span class="s2">public void </span><span class="s1">beforeTextChanged(CharSequence charSequence</span><span class="s2">, int </span><span class="s1">i</span><span class="s2">, int </span><span class="s1">i2</span><span class="s2">, int </span><span class="s1">i3) { 
 
                            } 
 
                            @Override 
                            </span><span class="s2">public void </span><span class="s1">onTextChanged(CharSequence charSequence</span><span class="s2">, int </span><span class="s1">i</span><span class="s2">, int </span><span class="s1">i2</span><span class="s2">, int </span><span class="s1">i3) { 
                                </span><span class="s2">int </span><span class="s1">int_nbr_letter = INT_BPM_LENGTH-charSequence.length()</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//value is ok</span><span class="s1"> 
                                </span><span class="s2">if</span><span class="s1">(int_nbr_letter &gt;= INT_ZERO) { 
                                    txtView_textWatcher.setTextColor(getResources().getColor(R.color.numbers_text_color))</span><span class="s2">;</span><span class="s1"> 
                                    txtView_textWatcher.setText(getString(R.string.left_caracters)+</span><span class="s5">&quot; &quot;</span><span class="s1">+String.valueOf(Math.abs(int_nbr_letter)))</span><span class="s2">;</span><span class="s1"> 
                                } 
                                </span><span class="s3">//text length is to big</span><span class="s1"> 
                                </span><span class="s2">else if</span><span class="s1">(int_nbr_letter &lt; INT_ZERO){ 
                                    </span><span class="s3">//set color to red</span><span class="s1"> 
                                    txtView_textWatcher.setTextColor(getResources().getColor(R.color.red))</span><span class="s2">;</span><span class="s1"> 
                                    txtView_textWatcher.setText(getString(R.string.over_caracters)+</span><span class="s5">&quot; &quot;</span><span class="s1">+String.valueOf(Math.abs(int_nbr_letter)))</span><span class="s2">;</span><span class="s1"> 
                                } 
                            } 
 
                            @Override 
                            </span><span class="s2">public void </span><span class="s1">afterTextChanged(Editable editable) { 
 
                            } 
                        }</span><span class="s2">;</span><span class="s1"> 
 
                        </span><span class="s3">/* link text Watcher to editText */</span><span class="s1"> 
                        edt_input.addTextChangedListener(mTextWatcher_forEdt_input)</span><span class="s2">;</span><span class="s1"> 
 
                        AlertDialog.Builder rest_alrt_builder = </span><span class="s2">new </span><span class="s1">AlertDialog.Builder(Timer.</span><span class="s2">this</span><span class="s1">) 
                                .setView(rest_dialog) 
                                .setMessage(getString(R.string.rest_indice)) 
                                .setPositiveButton(</span><span class="s5">&quot;Valider&quot;</span><span class="s2">, new </span><span class="s1">DialogInterface.OnClickListener() { 
                                    @Override 
                                    </span><span class="s2">public void </span><span class="s1">onClick(DialogInterface dialog</span><span class="s2">, int </span><span class="s1">which) { 
                                        </span><span class="s3">/* we use a Custum Listener to perform action see the class */</span><span class="s1"> 
                                    } 
                                }) 
                                .setTitle(getString(R.string.recup_title))</span><span class="s2">;</span><span class="s1"> 
                        </span><span class="s3">//create the builder</span><span class="s1"> 
                        alertDialog = rest_alrt_builder.create()</span><span class="s2">;</span><span class="s1"> 
                        alertDialog.show()</span><span class="s2">;</span><span class="s1"> 
 
 
                        </span><span class="s3">//link Button to the positive Button of the alertDialog</span><span class="s1"> 
                        Button positiveButton = alertDialog.getButton(DialogInterface.BUTTON_POSITIVE)</span><span class="s2">;</span><span class="s1"> 
                        </span><span class="s3">//link Button to Custom Listener</span><span class="s1"> 
                        positiveButton.setOnClickListener(</span><span class="s2">new </span><span class="s1">CheckValueTrainingListener(alertDialog</span><span class="s2">, </span><span class="s1">Timer.</span><span class="s2">this</span><span class="s1">))</span><span class="s2">;</span><span class="s1"> 
 
                    } 
                    </span><span class="s3">//return</span><span class="s1"> 
                    </span><span class="s2">return;</span><span class="s1"> 
                } </span><span class="s2">else </span><span class="s1">{ 
                    </span><span class="s3">//increment int_progess_value</span><span class="s1"> 
                    int_progress_value += INTERVALS</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">//increment int_progress_rowTime</span><span class="s1"> 
                    int_progress_rowTime += INTERVALS</span><span class="s2">;</span><span class="s1"> 
 
                    Log.w(</span><span class="s5">&quot;progress= row_time&quot;</span><span class="s2">, </span><span class="s1">int_progress_rowTime +</span><span class="s5">&quot;=&quot; </span><span class="s1">+int_row_time)</span><span class="s2">;</span><span class="s1"> 
 
                    </span><span class="s2">if</span><span class="s1">(int_progress_rowTime == int_row_time){ 
 
                        </span><span class="s3">//try to get All training Row</span><span class="s1"> 
                        lst_trainingRow = realmDB.getAllTrainingRows(_id)</span><span class="s2">;</span><span class="s1"> 
 
                        </span><span class="s3">//this if control the incrementation of i</span><span class="s1"> 
                        </span><span class="s2">if </span><span class="s1">(int_i &lt; lst_trainingRow.size() - </span><span class="s4">1</span><span class="s1">) { 
                            </span><span class="s3">//increment i</span><span class="s1"> 
                            int_i++</span><span class="s2">;</span><span class="s1"> 
 
                            </span><span class="s3">//create Training Row</span><span class="s1"> 
                            int_min = lst_trainingRow.get(int_i).getInt_min()</span><span class="s2">;</span><span class="s1"> 
                            int_sec = lst_trainingRow.get(int_i).getInt_sec()</span><span class="s2">;</span><span class="s1"> 
                            int_rpm = lst_trainingRow.get(int_i).getInt_rpm()</span><span class="s2">;</span><span class="s1"> 
                            int_bpm = lst_trainingRow.get(int_i).getInt_bpm()</span><span class="s2">;</span><span class="s1"> 
                            str_gear = lst_trainingRow.get(int_i).getStr_gear()</span><span class="s2">;</span><span class="s1"> 
                            str_time = lst_trainingRow.get(int_i).getStr_time()</span><span class="s2">;</span><span class="s1"> 
                            str_rythm = lst_trainingRow.get(int_i).getStr_rythm()</span><span class="s2">;</span><span class="s1"> 
                            str_work = lst_trainingRow.get(int_i).getStr_work()</span><span class="s2">;</span><span class="s1"> 
                            str_note = lst_trainingRow.get(int_i).getStr_note()</span><span class="s2">;</span><span class="s1"> 
 
                            </span><span class="s3">//set new max time for the row</span><span class="s1"> 
                            int_row_time = ((int_min * INT_SEC) + int_sec) * INT_MILLIS</span><span class="s2">;</span><span class="s1"> 
 
                            </span><span class="s3">/* only for the display we had 1000 millis. 
                            like this the bar is full */</span><span class="s1"> 
                            int_rowTime_display = int_row_time + </span><span class="s4">1000</span><span class="s2">;</span><span class="s1"> 
 
                            </span><span class="s3">//change max value</span><span class="s1"> 
                            prBar_row.setMax(int_row_time)</span><span class="s2">;</span><span class="s1"> 
 
                            </span><span class="s3">//on change set new value for the row</span><span class="s1"> 
                            txtView_timRow.setText(str_time)</span><span class="s2">;</span><span class="s1"> 
                            </span><span class="s3">//value for the row</span><span class="s1"> 
                            txtView_rpm_value.setText(int_rpm + </span><span class="s5">&quot;&quot;</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                            txtView_bpm_value.setText(int_bpm + </span><span class="s5">&quot;&quot;</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                            txtView_rythm_value.setText(str_rythm)</span><span class="s2">;</span><span class="s1"> 
                            txtView_work_value.setText(str_work)</span><span class="s2">;</span><span class="s1"> 
                            </span><span class="s3">//note and gear missing</span><span class="s1"> 
 
                            </span><span class="s3">//reset Progress to 0</span><span class="s1"> 
                            prBar_row.setProgress(</span><span class="s4">0</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
                            </span><span class="s3">//reset time row to 0;</span><span class="s1"> 
                            int_progress_rowTime = </span><span class="s4">0</span><span class="s2">;</span><span class="s1"> 
                        } 
                    }</span><span class="s3">//if</span><span class="s1"> 
 
                    </span><span class="s3">//set the progression to the progressBar (prBar_total)</span><span class="s1"> 
                    prBar_total.setProgress(int_progress_value)</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">//set the progression to the progressBar (prBar_row)</span><span class="s1"> 
                    prBar_row.setProgress(int_progress_rowTime)</span><span class="s2">;</span><span class="s1"> 
 
                    </span><span class="s3">//update CountDown Timer for the Row</span><span class="s1"> 
                    </span><span class="s3">//update the time in the screen for the countdown</span><span class="s1"> 
                    int_rowTime_display -= INTERVALS</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">//get the time in seconds by dividing by 1000</span><span class="s1"> 
                    </span><span class="s2">int </span><span class="s1">row_min = int_rowTime_display / INT_MILLIS</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">//divide row_min by 60 to get minutes. and row_min % 60 to get seconds</span><span class="s1"> 
                    txtView_timRow.setText(</span><span class="s5">&quot;&quot; </span><span class="s1">+ row_min / INT_SEC + </span><span class="s5">&quot;:&quot; </span><span class="s1">+ row_min % INT_SEC)</span><span class="s2">;</span><span class="s1"> 
                }</span><span class="s3">//else</span><span class="s1"> 
            </span><span class="s3">//THE TRICK FOR THE TIMER IS HERE</span><span class="s1"> 
            </span><span class="s3">//delayed post handler every 100 mililSecond</span><span class="s1"> 
            handler.postDelayed(</span><span class="s2">this, </span><span class="s4">100</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
 
        } 
 
        </span><span class="s2">public void </span><span class="s1">killRunnable(){ 
            </span><span class="s3">//when timer is paused or stopped isCanceled is set to true.</span><span class="s1"> 
            isCanceled = </span><span class="s2">true;</span><span class="s1"> 
        } 
 
    }</span><span class="s3">//Class TimerRunnable</span><span class="s1"> 
 
    </span><span class="s0">/******************************************************************** 
     * Name: onStop Method 
     * Goal: Method called when the phone stop the Avtivity 
     ***********************************************************************/</span><span class="s1"> 
    @Override 
    </span><span class="s2">protected void </span><span class="s1">onStop() { 
        </span><span class="s2">super</span><span class="s1">.onStop()</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s3">//close Realm Instance</span><span class="s1"> 
        realmDB.close()</span><span class="s2">;</span><span class="s1"> 
    } 
 
    </span><span class="s0">/******************************************************************** 
     * Name: onDestroy Method 
     * Goal: Method called when the phone kill the Avtivity 
     ***********************************************************************/</span><span class="s1"> 
    @Override 
    </span><span class="s2">protected void </span><span class="s1">onDestroy() { 
        </span><span class="s2">super</span><span class="s1">.onDestroy()</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s3">//set to null objects that may take memory</span><span class="s1"> 
        lst_trainingRow = </span><span class="s2">null;</span><span class="s1"> 
        handler = </span><span class="s2">null;</span><span class="s1"> 
        runnable = </span><span class="s2">null;</span><span class="s1"> 
        alertDialog = </span><span class="s2">null;</span><span class="s1"> 
        </span><span class="s3">//free memory</span><span class="s1"> 
        freeMemory()</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s2">if </span><span class="s1">(runnable != </span><span class="s2">null</span><span class="s1">){ 
            </span><span class="s3">// kill runnable if the activity is destroyed</span><span class="s1"> 
            runnable.killRunnable()</span><span class="s2">;</span><span class="s1"> 
 
        } 
    } 
 
    </span><span class="s0">/******************************************************************** 
     * Name: freeMemory 
     * Goal: Run the garbage collector to get back some allocated memory 
     ***********************************************************************/</span><span class="s1"> 
    </span><span class="s2">public void </span><span class="s1">freeMemory(){ 
        System.runFinalization()</span><span class="s2">;</span><span class="s1"> 
        Runtime.getRuntime().gc()</span><span class="s2">;</span><span class="s1"> 
        System.gc()</span><span class="s2">;</span><span class="s1"> 
    } 
 
 
    </span><span class="s0">/******************************************************************** 
     * Name: onBackPressed 
     * Goal: Method called when the user press on the back Button of the phone 
     ***********************************************************************/</span><span class="s1"> 
    @Override 
    </span><span class="s2">public void </span><span class="s1">onBackPressed() { 
        </span><span class="s2">super</span><span class="s1">.onBackPressed()</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s3">//check with an alertDialog if the user realy wants to stop the training.</span><span class="s1"> 
                AlertDialog.Builder builder = </span><span class="s2">new </span><span class="s1">AlertDialog.Builder(mContext) 
                        .setCancelable(</span><span class="s2">false</span><span class="s1">) 
                        .setTitle(getResources().getString(R.string.stop_timer)) 
                        .setMessage(getResources().getString(R.string.stop_message)) 
                        .setPositiveButton(</span><span class="s5">&quot;OUI&quot;</span><span class="s2">, new </span><span class="s1">DialogInterface.OnClickListener() { 
                            @Override 
                            </span><span class="s2">public void </span><span class="s1">onClick(DialogInterface dialogInterface</span><span class="s2">, int </span><span class="s1">i) { 
                                </span><span class="s3">//go back to previous activiy if positive button is hit</span><span class="s1"> 
                                Intent intent_trainingRow = </span><span class="s2">new </span><span class="s1">Intent(Timer.</span><span class="s2">this, </span><span class="s1">TrainingRowActivity.</span><span class="s2">class</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//put extra id to get all Rows back</span><span class="s1"> 
                                intent_trainingRow.putExtra(</span><span class="s5">&quot;_id&quot;</span><span class="s2">, </span><span class="s1">_id)</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//put a Flag to avoid recreate intent if he already exist in the queue</span><span class="s1"> 
                                intent_trainingRow.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//get context to startActivity</span><span class="s1"> 
                                mContext.startActivity(intent_trainingRow)</span><span class="s2">;</span><span class="s1"> 
                                </span><span class="s3">//finish and cancel activty</span><span class="s1"> 
                                finish()</span><span class="s2">;</span><span class="s1"> 
                            } 
                        }) 
                        .setNegativeButton(</span><span class="s5">&quot;NON&quot;</span><span class="s2">, new </span><span class="s1">DialogInterface.OnClickListener() { 
                            @Override 
                            </span><span class="s2">public void </span><span class="s1">onClick(DialogInterface dialogInterface</span><span class="s2">, int </span><span class="s1">i) { 
                                </span><span class="s3">//cancel the alertDialog</span><span class="s1"> 
                                dialogInterface.dismiss()</span><span class="s2">;</span><span class="s1"> 
                            } 
                        })</span><span class="s2">;</span><span class="s1"> 
                </span><span class="s3">//from the builder create the alertDialog</span><span class="s1"> 
                alertDialog = builder.create()</span><span class="s2">;</span><span class="s1"> 
                </span><span class="s3">//show the dialog to user</span><span class="s1"> 
                alertDialog.show()</span><span class="s2">;</span><span class="s1"> 
    } 
 
    </span><span class="s0">/******************************************************************** 
     * Name: isNumeric 
     * Goal: Method to check if the string is numeric or not 
     ***********************************************************************/</span><span class="s1"> 
    </span><span class="s2">public static boolean </span><span class="s1">isNumeric(String str) 
    { 
        NumberFormat formatter = NumberFormat.getInstance()</span><span class="s2">;</span><span class="s1"> 
        ParsePosition pos = </span><span class="s2">new </span><span class="s1">ParsePosition(</span><span class="s4">0</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
        formatter.parse(str</span><span class="s2">, </span><span class="s1">pos)</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s2">return </span><span class="s1">str.length() == pos.getIndex()</span><span class="s2">;</span><span class="s1"> 
    } 
 
    </span><span class="s0">/******************************************************************************* 
     * 
     * private class Custom Listener to check data control on the check Box 
     * 
     **********************************************************************************/</span><span class="s1"> 
    </span><span class="s2">class </span><span class="s1">CheckValueTrainingListener </span><span class="s2">implements </span><span class="s1">View.OnClickListener{ 
        </span><span class="s2">private final </span><span class="s1">Dialog dialog</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s2">private final </span><span class="s1">Context context</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s2">public </span><span class="s1">CheckValueTrainingListener (Dialog dialog</span><span class="s2">, </span><span class="s1">Context mContext){ 
            </span><span class="s2">this</span><span class="s1">.dialog = dialog</span><span class="s2">;</span><span class="s1"> 
            </span><span class="s2">this</span><span class="s1">.context = mContext</span><span class="s2">;</span><span class="s1"> 
        } 
 
        @Override 
        </span><span class="s2">public void </span><span class="s1">onClick(View view) { 
            </span><span class="s3">//get the value of the bpm from editText</span><span class="s1"> 
            String mValue = edt_input.getText().toString()</span><span class="s2">;</span><span class="s1"> 
            </span><span class="s2">int </span><span class="s1">int_value</span><span class="s2">;</span><span class="s1"> 
 
            </span><span class="s3">//test if heartRate are numbers</span><span class="s1"> 
            </span><span class="s2">try</span><span class="s1">{ 
                </span><span class="s3">//test if value is an integer</span><span class="s1"> 
                int_value = Integer.parseInt(mValue)</span><span class="s2">;</span><span class="s1"> 
 
                </span><span class="s3">//if they are numbers but not into the limits</span><span class="s1"> 
                </span><span class="s2">if</span><span class="s1">(int_value &gt; INT_MAX_BPM || int_value &lt; INT_MIN_BPM){ 
                    Toast.makeText(Timer.</span><span class="s2">this, </span><span class="s1">getResources().getString(R.string.error_limits_indice)</span><span class="s2">, </span><span class="s1">Toast.LENGTH_SHORT).show()</span><span class="s2">;</span><span class="s1"> 
                }</span><span class="s2">else </span><span class="s3">//means that value is into the limits</span><span class="s1"> 
                { 
                    </span><span class="s3">//call realmDB instance to set the rest indice</span><span class="s1"> 
                    realmDB.setRestIndice(_id</span><span class="s2">, </span><span class="s1">int_value)</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">//everything is ok dismiss the dialog</span><span class="s1"> 
                    dialog.dismiss()</span><span class="s2">;</span><span class="s1"> 
 
                    </span><span class="s3">//go back to Training Intent</span><span class="s1"> 
                    Intent back_toTrainingAvtivity = </span><span class="s2">new </span><span class="s1">Intent(Timer.</span><span class="s2">this, </span><span class="s1">TrainingActivity.</span><span class="s2">class</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">//clear activity to avoid error getting acces to realm DB</span><span class="s1"> 
                    back_toTrainingAvtivity.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">//start Activity</span><span class="s1"> 
                    context.startActivity(back_toTrainingAvtivity)</span><span class="s2">;</span><span class="s1"> 
                    </span><span class="s3">//finish</span><span class="s1"> 
                    finish()</span><span class="s2">;</span><span class="s1"> 
                } 
                </span><span class="s3">//error can be catched if values is empty or value is text</span><span class="s1"> 
            }</span><span class="s2">catch </span><span class="s1">(Exception e){ 
                </span><span class="s3">//if value is empty</span><span class="s1"> 
                </span><span class="s2">if</span><span class="s1">(mValue.length() == INT_ZERO || mValue.length() == INT_ZERO){ 
                    Toast.makeText(Timer.</span><span class="s2">this, </span><span class="s1">getResources().getString(R.string.error_bpm_empty)</span><span class="s2">, </span><span class="s1">Toast.LENGTH_SHORT).show()</span><span class="s2">;</span><span class="s1"> 
                }</span><span class="s2">else</span><span class="s1">{</span><span class="s3">//else if value are not empty but not integer... so they are text</span><span class="s1"> 
                    Toast.makeText(Timer.</span><span class="s2">this, </span><span class="s1">getResources().getString(R.string.error_integer)</span><span class="s2">, </span><span class="s1">Toast.LENGTH_SHORT).show()</span><span class="s2">;</span><span class="s1"> 
                } 
            } 
        }</span><span class="s3">//onClick</span><span class="s1"> 
    }</span><span class="s3">// class CheckValueTrainingListener</span><span class="s1"> 
}</span><span class="s3">//Class Timer</span><span class="s1"> 
</span></pre>
</body>
</html>